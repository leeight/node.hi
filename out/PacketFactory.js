var ECtFlagConnectStates;
(function (ECtFlagConnectStates) {
    ECtFlagConnectStates._map = [];
    ECtFlagConnectStates.CT_FLAG_CON_S1 = 0;
    ECtFlagConnectStates.CT_FLAG_CON_S2 = 1;
    ECtFlagConnectStates.CT_FLAG_CON_S3 = 2;
    ECtFlagConnectStates.CT_FLAG_CON_S4 = 3;
    ECtFlagConnectStates.CT_FLAG_KEEPALIVE = 37;
    ECtFlagConnectStates.CT_FLAG_CON_OK = 31;
    ECtFlagConnectStates.CT_FLAG_CON_OK_NOZIP_NOAES = 7;
    ECtFlagConnectStates.CT_FLAG_CON_OK_NOZIP_DOAES = 15;
    ECtFlagConnectStates.CT_FLAG_CON_OK_DOZIP_NOAES = 23;
})(ECtFlagConnectStates || (ECtFlagConnectStates = {}));

var ECtSendFlags;
(function (ECtSendFlags) {
    ECtSendFlags._map = [];
    ECtSendFlags.CT_SEND_FLAG_HANDSHAKE = 0;
    ECtSendFlags.CT_SEND_FLAG_LOGIN = 1;
    ECtSendFlags.CT_SEND_FLAG_LOGOUT = 2;
})(ECtSendFlags || (ECtSendFlags = {}));

var ProtocolConstant = (function () {
    function ProtocolConstant() { }
    ProtocolConstant.MAX_METHOD = 4;
    ProtocolConstant.SYM_METHOD_NONE = 0;
    ProtocolConstant.SYM_METHOD_AES = 1;
    ProtocolConstant.SYM_METHOD_DES = 2;
    ProtocolConstant.UNSYM_METHOD_NONE = 0;
    ProtocolConstant.UNSYM_METHOD_RSA = 1;
    ProtocolConstant.ZIP_METHOD_NONE = 0;
    ProtocolConstant.ZIP_METHOD_COMPRESS = 1;
    ProtocolConstant.CON_METHOD_NULL = 0;
    ProtocolConstant.CON_METHOD_NONE = 1;
    ProtocolConstant.CON_METHOD_A = new Int8Array([
        2, 
        0, 
        0, 
        0
    ]);
    ProtocolConstant.CT_TAG = 'IMV1';
    ProtocolConstant.BIN_PRO_VER_1_0 = 1;
    ProtocolConstant.PAKECT_HEAD_LENGTH = 40;
    return ProtocolConstant;
})();
var IM_RootPubKeyData = [
    [
        48, 
        -127, 
        -119, 
        2, 
        -127, 
        -127, 
        0, 
        -23, 
        98, 
        119, 
        -58, 
        -105, 
        120, 
        88, 
        -64, 
        40, 
        -29, 
        -127, 
        -54, 
        -107, 
        -43, 
        -72, 
        19, 
        69, 
        81, 
        -44, 
        -117, 
        106, 
        -60, 
        -46, 
        42, 
        -29, 
        97, 
        16, 
        -84, 
        -27, 
        58, 
        -91, 
        -87, 
        72, 
        -82, 
        63, 
        21, 
        3, 
        76, 
        -42, 
        -92, 
        88, 
        7, 
        -113, 
        -71, 
        83, 
        29, 
        -5, 
        -15, 
        -123, 
        -72, 
        -75, 
        -108, 
        -11, 
        78, 
        89, 
        122, 
        -9, 
        -76, 
        -68, 
        113, 
        41, 
        39, 
        -4, 
        -38, 
        53, 
        53, 
        -117, 
        66, 
        126, 
        118, 
        107, 
        -89, 
        -94, 
        14, 
        70, 
        126, 
        91, 
        -106, 
        -16, 
        -65, 
        -96, 
        10, 
        -126, 
        -108, 
        -49, 
        -32, 
        51, 
        65, 
        120, 
        -127, 
        -96, 
        -10, 
        10, 
        -122, 
        -4, 
        23, 
        -21, 
        -18, 
        -29, 
        -12, 
        -104, 
        -89, 
        52, 
        74, 
        111, 
        -34, 
        -85, 
        114, 
        102, 
        66, 
        -93, 
        -34, 
        -15, 
        114, 
        -112, 
        -25, 
        -112, 
        -4, 
        -104, 
        -86, 
        9, 
        93, 
        119, 
        -27, 
        -94, 
        31, 
        -49, 
        -87, 
        2, 
        3, 
        1, 
        0, 
        1
    ], 
    [
        48, 
        -127, 
        -119, 
        2, 
        -127, 
        -127, 
        0, 
        -42, 
        -42, 
        9, 
        59, 
        3, 
        -67, 
        -101, 
        -28, 
        119, 
        103, 
        -44, 
        122, 
        -50, 
        13, 
        -92, 
        -91, 
        57, 
        20, 
        65, 
        -53, 
        103, 
        73, 
        96, 
        -25, 
        -45, 
        -114, 
        100, 
        -114, 
        16, 
        -88, 
        29, 
        68, 
        -78, 
        86, 
        114, 
        -108, 
        -71, 
        -73, 
        119, 
        -64, 
        34, 
        127, 
        -93, 
        -116, 
        -86, 
        -42, 
        61, 
        69, 
        -61, 
        32, 
        73, 
        -123, 
        -5, 
        -122, 
        -93, 
        88, 
        76, 
        87, 
        90, 
        9, 
        -40, 
        28, 
        26, 
        -37, 
        -41, 
        124, 
        79, 
        35, 
        43, 
        -3, 
        -75, 
        -24, 
        99, 
        -126, 
        80, 
        64, 
        73, 
        -57, 
        -17, 
        75, 
        101, 
        -42, 
        -47, 
        115, 
        76, 
        -80, 
        -101, 
        124, 
        -51, 
        12, 
        34, 
        -120, 
        -63, 
        -14, 
        19, 
        89, 
        -105, 
        30, 
        -8, 
        -11, 
        -19, 
        -76, 
        111, 
        24, 
        50, 
        69, 
        0, 
        -7, 
        109, 
        -76, 
        47, 
        -87, 
        -8, 
        -60, 
        45, 
        73, 
        86, 
        -75, 
        -32, 
        -56, 
        127, 
        -68, 
        2, 
        -119, 
        -31, 
        21, 
        -28, 
        41, 
        2, 
        3, 
        1, 
        0, 
        1
    ], 
    [
        48, 
        -127, 
        -119, 
        2, 
        -127, 
        -127, 
        0, 
        -57, 
        -71, 
        99, 
        -73, 
        -88, 
        -59, 
        67, 
        78, 
        -42, 
        -47, 
        -84, 
        -74, 
        -59, 
        -20, 
        -111, 
        -109, 
        -47, 
        14, 
        127, 
        110, 
        19, 
        68, 
        -111, 
        70, 
        116, 
        -74, 
        -45, 
        -128, 
        104, 
        -28, 
        108, 
        -124, 
        -121, 
        34, 
        92, 
        -38, 
        5, 
        46, 
        113, 
        -17, 
        -37, 
        24, 
        -105, 
        77, 
        93, 
        84, 
        22, 
        53, 
        -14, 
        -8, 
        -64, 
        -3, 
        107, 
        124, 
        -19, 
        -58, 
        25, 
        61, 
        -122, 
        4, 
        80, 
        -20, 
        16, 
        127, 
        -10, 
        -84, 
        30, 
        -124, 
        9, 
        -102, 
        -14, 
        -97, 
        -47, 
        -94, 
        -6, 
        -10, 
        -62, 
        21, 
        83, 
        113, 
        -80, 
        77, 
        86, 
        113, 
        114, 
        -57, 
        -112, 
        89, 
        -4, 
        -21, 
        -42, 
        -3, 
        -5, 
        -25, 
        -58, 
        23, 
        36, 
        120, 
        23, 
        39, 
        13, 
        108, 
        -101, 
        -28, 
        -5, 
        113, 
        50, 
        125, 
        -90, 
        36, 
        -92, 
        -83, 
        -15, 
        78, 
        88, 
        -67, 
        -79, 
        -33, 
        49, 
        -69, 
        90, 
        -43, 
        76, 
        3, 
        79, 
        73, 
        -119, 
        59, 
        2, 
        3, 
        1, 
        0, 
        1
    ], 
    [
        48, 
        -127, 
        -119, 
        2, 
        -127, 
        -127, 
        0, 
        -87, 
        22, 
        -13, 
        -23, 
        -73, 
        -80, 
        -100, 
        96, 
        17, 
        76, 
        -109, 
        -81, 
        45, 
        -31, 
        -87, 
        12, 
        -32, 
        -123, 
        -57, 
        112, 
        124, 
        -56, 
        33, 
        -42, 
        67, 
        -57, 
        9, 
        -97, 
        97, 
        -52, 
        -45, 
        120, 
        -86, 
        5, 
        -22, 
        84, 
        61, 
        -66, 
        -105, 
        0, 
        -91, 
        2, 
        -102, 
        76, 
        99, 
        46, 
        113, 
        88, 
        59, 
        -102, 
        -127, 
        63, 
        34, 
        -116, 
        74, 
        125, 
        -52, 
        3, 
        -38, 
        -3, 
        39, 
        96, 
        114, 
        8, 
        -102, 
        -94, 
        95, 
        -1, 
        -1, 
        -124, 
        -60, 
        39, 
        53, 
        -70, 
        -21, 
        -58, 
        -79, 
        95, 
        -107, 
        -14, 
        41, 
        -34, 
        -71, 
        -100, 
        109, 
        -89, 
        122, 
        63, 
        -30, 
        67, 
        -3, 
        -60, 
        47, 
        124, 
        21, 
        -4, 
        16, 
        69, 
        76, 
        -102, 
        -110, 
        47, 
        -57, 
        -96, 
        113, 
        -128, 
        101, 
        -25, 
        48, 
        50, 
        0, 
        -66, 
        -93, 
        -67, 
        -57, 
        -124, 
        -20, 
        -21, 
        -51, 
        -52, 
        -31, 
        -102, 
        120, 
        -58, 
        -82, 
        -53, 
        -92, 
        45, 
        2, 
        3, 
        1, 
        0, 
        1
    ], 
    [
        48, 
        -127, 
        -119, 
        2, 
        -127, 
        -127, 
        0, 
        -73, 
        41, 
        71, 
        -100, 
        38, 
        -6, 
        72, 
        51, 
        89, 
        -77, 
        64, 
        -40, 
        -81, 
        -72, 
        -49, 
        -76, 
        -124, 
        103, 
        70, 
        4, 
        2, 
        26, 
        37, 
        112, 
        -110, 
        -102, 
        120, 
        124, 
        -85, 
        -115, 
        -103, 
        17, 
        -56, 
        -3, 
        28, 
        -48, 
        -30, 
        70, 
        -37, 
        87, 
        -58, 
        27, 
        0, 
        -20, 
        109, 
        115, 
        -82, 
        -109, 
        -33, 
        -20, 
        -16, 
        -98, 
        -37, 
        -103, 
        123, 
        -25, 
        11, 
        123, 
        20, 
        96, 
        111, 
        111, 
        -83, 
        -19, 
        -106, 
        -44, 
        16, 
        -29, 
        35, 
        -127, 
        -103, 
        -13, 
        113, 
        81, 
        -104, 
        -86, 
        -59, 
        -18, 
        -11, 
        93, 
        62, 
        69, 
        -77, 
        80, 
        85, 
        24, 
        -80, 
        106, 
        43, 
        -43, 
        28, 
        -80, 
        -102, 
        29, 
        -73, 
        101, 
        11, 
        20, 
        -29, 
        61, 
        -33, 
        107, 
        120, 
        34, 
        -62, 
        115, 
        121, 
        101, 
        11, 
        -25, 
        7, 
        -119, 
        -67, 
        -31, 
        -24, 
        -81, 
        -116, 
        -59, 
        -96, 
        76, 
        81, 
        -14, 
        46, 
        67, 
        107, 
        74, 
        -26, 
        113, 
        2, 
        3, 
        1, 
        0, 
        1
    ], 
    [
        48, 
        -127, 
        -119, 
        2, 
        -127, 
        -127, 
        0, 
        -44, 
        47, 
        -46, 
        -100, 
        -101, 
        126, 
        111, 
        -100, 
        -68, 
        -109, 
        88, 
        37, 
        1, 
        -12, 
        81, 
        -57, 
        -3, 
        2, 
        40, 
        43, 
        -108, 
        126, 
        -92, 
        -76, 
        -100, 
        -57, 
        120, 
        87, 
        -51, 
        -28, 
        67, 
        76, 
        -51, 
        -123, 
        90, 
        -8, 
        44, 
        -46, 
        49, 
        109, 
        0, 
        94, 
        32, 
        -23, 
        -74, 
        -116, 
        66, 
        127, 
        -95, 
        -53, 
        41, 
        -88, 
        -3, 
        -30, 
        -24, 
        -88, 
        -6, 
        60, 
        9, 
        36, 
        -16, 
        -23, 
        67, 
        -83, 
        -10, 
        25, 
        -17, 
        -62, 
        116, 
        -59, 
        -64, 
        116, 
        38, 
        -16, 
        3, 
        118, 
        99, 
        40, 
        124, 
        107, 
        20, 
        111, 
        -7, 
        7, 
        14, 
        78, 
        102, 
        49, 
        114, 
        -35, 
        13, 
        125, 
        57, 
        -49, 
        -128, 
        -128, 
        0, 
        -49, 
        42, 
        -7, 
        -55, 
        20, 
        6, 
        -6, 
        -74, 
        99, 
        73, 
        43, 
        4, 
        13, 
        89, 
        103, 
        40, 
        121, 
        96, 
        -106, 
        -17, 
        92, 
        68, 
        -27, 
        -69, 
        13, 
        87, 
        72, 
        22, 
        -101, 
        68, 
        77, 
        2, 
        3, 
        1, 
        0, 
        1
    ], 
    [
        48, 
        -127, 
        -119, 
        2, 
        -127, 
        -127, 
        0, 
        -70, 
        45, 
        -33, 
        49, 
        -94, 
        0, 
        86, 
        39, 
        -109, 
        95, 
        -32, 
        -111, 
        -54, 
        87, 
        -50, 
        -27, 
        51, 
        51, 
        77, 
        -18, 
        95, 
        44, 
        44, 
        -90, 
        -8, 
        21, 
        -58, 
        -85, 
        86, 
        63, 
        40, 
        95, 
        82, 
        -47, 
        -37, 
        -125, 
        42, 
        99, 
        106, 
        111, 
        -9, 
        -39, 
        -68, 
        -83, 
        -63, 
        42, 
        -116, 
        64, 
        43, 
        26, 
        -128, 
        12, 
        13, 
        -112, 
        -125, 
        -37, 
        -112, 
        119, 
        86, 
        -86, 
        48, 
        47, 
        -7, 
        52, 
        79, 
        100, 
        0, 
        9, 
        -72, 
        30, 
        30, 
        32, 
        119, 
        104, 
        42, 
        16, 
        32, 
        24, 
        23, 
        111, 
        -120, 
        -40, 
        -13, 
        58, 
        24, 
        37, 
        -54, 
        60, 
        63, 
        116, 
        -99, 
        31, 
        4, 
        45, 
        103, 
        -103, 
        -56, 
        -66, 
        -120, 
        -75, 
        -29, 
        -28, 
        -50, 
        -26, 
        77, 
        -123, 
        86, 
        -55, 
        -1, 
        39, 
        23, 
        -97, 
        46, 
        -91, 
        -60, 
        -24, 
        43, 
        116, 
        92, 
        -70, 
        -126, 
        112, 
        -58, 
        -109, 
        -55, 
        -51, 
        -9, 
        7, 
        2, 
        3, 
        1, 
        0, 
        1
    ], 
    [
        48, 
        -127, 
        -119, 
        2, 
        -127, 
        -127, 
        0, 
        -73, 
        -114, 
        26, 
        -85, 
        -63, 
        -68, 
        64, 
        -76, 
        77, 
        -83, 
        -103, 
        98, 
        111, 
        125, 
        -16, 
        85, 
        -15, 
        60, 
        -90, 
        77, 
        -121, 
        -7, 
        43, 
        14, 
        49, 
        88, 
        84, 
        126, 
        -94, 
        79, 
        -86, 
        14, 
        -52, 
        -104, 
        19, 
        62, 
        -113, 
        -21, 
        -67, 
        48, 
        -67, 
        70, 
        -27, 
        44, 
        -126, 
        106, 
        96, 
        -117, 
        -105, 
        109, 
        66, 
        47, 
        -11, 
        102, 
        37, 
        -29, 
        -89, 
        -79, 
        101, 
        -30, 
        -85, 
        4, 
        -109, 
        30, 
        31, 
        84, 
        -67, 
        -42, 
        -12, 
        50, 
        -66, 
        -114, 
        9, 
        -38, 
        -101, 
        107, 
        -16, 
        -28, 
        107, 
        107, 
        -92, 
        64, 
        -85, 
        66, 
        53, 
        116, 
        -37, 
        101, 
        36, 
        37, 
        27, 
        -72, 
        1, 
        102, 
        -93, 
        88, 
        79, 
        117, 
        31, 
        -10, 
        -8, 
        87, 
        -43, 
        -108, 
        -20, 
        82, 
        53, 
        -27, 
        63, 
        -93, 
        -7, 
        14, 
        99, 
        -101, 
        23, 
        -128, 
        89, 
        36, 
        -48, 
        41, 
        21, 
        -71, 
        -58, 
        -118, 
        -34, 
        68, 
        -35, 
        101, 
        2, 
        3, 
        1, 
        0, 
        1
    ]
];
var PacketHead = (function () {
    function PacketHead(ctFlag, nSrcDataLen, nZipDataLen, nDestDataLen) {
        this.nVer = new Int8Array([
            0, 
            0, 
            1, 
            0
        ]);
        this.nTag = ProtocolConstant.CT_TAG;
        this.bEncrypt = 1;
        this.bCompress = 1;
        this.bHeartBeat = 1;
        this.nReserved26 = 26;
        this.nSendFlag = ECtSendFlags.CT_SEND_FLAG_LOGIN;
        this.nCategory = 0;
        this.nReserved1 = 0;
        this.nReserved2 = 0;
        this.ctFlag = ctFlag;
        this.nSrcDataLen = nSrcDataLen;
        this.nZipDataLen = nZipDataLen;
        this.nDestDataLen = nDestDataLen;
    }
    PacketHead.S1 = new PacketHead(ECtFlagConnectStates.CT_FLAG_CON_S1, 0, 0, 0);
    PacketHead.S2 = new PacketHead(ECtFlagConnectStates.CT_FLAG_CON_S2, 0, 0, 0);
    PacketHead.S3 = new PacketHead(ECtFlagConnectStates.CT_FLAG_CON_S3, 0, 0, 0);
    PacketHead.S4 = new PacketHead(ECtFlagConnectStates.CT_FLAG_CON_S4, 0, 0, 0);
    PacketHead.MESSAGE = new PacketHead(ECtFlagConnectStates.CT_FLAG_CON_OK, 0, 0, 0);
    PacketHead.HEARTBEAT = new PacketHead(ECtFlagConnectStates.CT_FLAG_KEEPALIVE, 0, 0, 0);
    PacketHead.prototype.getBytes = function () {
        return new Int8Array([]);
    };
    PacketHead.prototype.createFromBytes = function () {
        return new PacketHead(0, 0, 0, 0);
    };
    return PacketHead;
})();
var Message = (function () {
    function Message(data) {
        this.data = data;
    }
    Message.prototype.getBytes = function () {
        if(this.message == null) {
            return this.data;
        }
        return new Int8Array([
            0
        ]);
    };
    return Message;
})();
var HandshakeHead = (function () {
    function HandshakeHead() {
        this.nReserved1 = 0;
        this.nReserved2 = 0;
        this.nDataLen = 0;
    }
    HandshakeHead.prototype.getBytes = function () {
        return null;
    };
    return HandshakeHead;
})();
var HandshakeBody = (function () {
    function HandshakeBody() { }
    HandshakeBody.prototype.getLength = function () {
        if(this.keyData != null) {
            return this.keyData.length;
        } else {
            return 0;
        }
    };
    return HandshakeBody;
})();
var Utils = (function () {
    function Utils() { }
    Utils.sumArray = function sumArray(a, b) {
        return new Int8Array([]);
    }
    return Utils;
})();
var Packet = (function () {
    function Packet(packetHead, handshakeHead, handshakeBody) {
        this.packetHead = packetHead;
        this.handshakeHead = handshakeHead;
        this.handshakeBody = handshakeBody;
    }
    Packet.keepAlive = new Packet(PacketHead.HEARTBEAT, null, null);
    Packet.prototype.getBytes = function () {
        var result = null;
        var ctFlag = this.packetHead.ctFlag;
        switch(ctFlag) {
            case ECtFlagConnectStates.CT_FLAG_CON_S1: {
                result = Utils.sumArray(this.packetHead.getBytes(), this.handshakeHead.getBytes());
                break;

            }
            case ECtFlagConnectStates.CT_FLAG_CON_S2: {
                break;

            }
            case ECtFlagConnectStates.CT_FLAG_CON_S3: {
                result = Utils.sumArray(this.packetHead.getBytes(), this.handshakeHead.getBytes());
                if(this.handshakeBody == null) {
                    return null;
                }
                result = Utils.sumArray(result, this.handshakeBody.keyData);
                break;

            }
            case ECtFlagConnectStates.CT_FLAG_CON_S4: {
                break;

            }
            case ECtFlagConnectStates.CT_FLAG_CON_OK: {
                result = Utils.sumArray(this.packetHead.getBytes(), this.message.getBytes());
                break;

            }
            case ECtFlagConnectStates.CT_FLAG_KEEPALIVE: {
                result = this.packetHead.getBytes();
                break;

            }
            default: {
                break;

            }
        }
        return result;
    };
    return Packet;
})();
var __extends = this.__extends || function (d, b) {
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
}
var S2Data = (function (_super) {
    __extends(S2Data, _super);
    function S2Data() {
        _super.apply(this, arguments);

    }
    S2Data.prototype.getBytes = function () {
        return new Int8Array(0);
    };
    S2Data.createFromBytes = function createFromBytes(data) {
        return new S2Data();
    }
    return S2Data;
})(HandshakeHead);
var S4Data = (function (_super) {
    __extends(S4Data, _super);
    function S4Data() {
        _super.apply(this, arguments);

        this.seed = new Int8Array(16);
    }
    S4Data.prototype.getBytes = function () {
        return new Int8Array(0);
    };
    S4Data.createFromBytes = function createFromBytes(data) {
        return new S4Data();
    }
    return S4Data;
})(HandshakeHead);
